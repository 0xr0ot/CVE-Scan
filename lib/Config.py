#!/usr/bin/env python3.3
# _*_ coding: utf-8 _*_
#
# Read configuration file or return default values
#
# Copyright (c) 2015	Pieter-Jan Moreels

# Imports
import os
import sys
runpath=os.path.dirname(os.path.realpath(__file__))

import pymongo

import configparser

class Configuration(config=None):
  cp=configparser.ConfigParser()
  if not config:
    cp.read(os.path.join(runpath, '../configuration.ini'))
  else:
    cp.read(config)
  default={'mongoHost': 'localhost', 'mongoPort': 27017,
           'mongoDB': 'cvedb' }

  @classmethod
  def read(cls, section, item, default):
    result=default
    try:
      if type(default) == bool:
        result=cls.cp.getboolean(section, item)
      elif type(default) == int:
        result=cls.cp.getint(section, item)
      else:
        result=cls.cp.get(section,item)
    except:
      pass
    return result

  # Mongo
  @classmethod
  def getMongoConnection(cls, host=None, port=None, db=None):
    h=host if host else cls.read('Mongo','Host',cls.default['mongoHost'])
    p=port if port else cls.read('Mongo','Port',cls.default['mongoPort'])
    d=db if db else cls.read('Mongo','DB',cls.default['mongoDB'])
    c=pymongo.MongoClient(h,p)
    return connect[d]
